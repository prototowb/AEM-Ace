import{d as I,c as n,a as t,l as O,w as u,v as c,b as f,t as m,F as k,r as h,k as _,m as q,e as g,g as V,h as l}from"./runtime-dom.esm-bundler.CzleRXFB.js";import{_ as U}from"./_plugin-vue_export-helper.DlAUqK2U.js";const N=I({__name:"QuestionSubmission",props:{categories:{}},setup(y,{expose:o}){o();const x=y,e=q({title:"",question:"",options:["",""],correctAnswers:[],explanation:"",categoryId:"",difficulty:"",tags:[],submitterName:"",submitterEmail:"",website:""}),d=q({}),b=g(!1),r=g(""),a=g(""),p=g("");V(p,i=>{e.tags=i.split(",").map(s=>s.trim()).filter(Boolean).slice(0,10)});function S(){e.options.length<6&&e.options.push("")}function A(i){e.options.length<=2||(e.options.splice(i,1),e.correctAnswers=e.correctAnswers.filter(s=>s!==i).map(s=>s>i?s-1:s))}function C(i){const s=e.correctAnswers.indexOf(i);s>=0?e.correctAnswers.splice(s,1):e.correctAnswers.push(i)}function v(){Object.keys(d).forEach(s=>delete d[s]),e.title.trim()||(d.title="Title is required."),e.question.trim()||(d.question="Question text is required.");const i=e.options.map(s=>s.trim()).filter(Boolean);return(e.options.length<2||e.options.length>6)&&(d.options="Provide between 2 and 6 options."),i.length!==e.options.length&&(d.options="All options must be filled in."),e.correctAnswers.length<1&&(d.correctAnswers="Select at least one correct answer."),e.categoryId||(d.categoryId="Category is required."),e.difficulty||(d.difficulty="Difficulty is required."),Object.keys(d).length===0}async function E(){if(r.value="",a.value="",!!v()){if(e.website){r.value="Thanks for your submission!";return}b.value=!0;try{const i=await fetch("/api/submit-question",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:e.title,question:e.question,options:e.options,correctAnswers:e.correctAnswers,explanation:e.explanation||void 0,categoryId:e.categoryId,difficulty:e.difficulty,tags:e.tags,submitterName:e.submitterName||void 0,submitterEmail:e.submitterEmail||void 0,website:e.website})});if(!i.ok){const s=await i.json().catch(()=>({}));throw new Error(s.message||"Submission failed. Please try again later.")}r.value="Thanks! Your question was submitted for review.",e.title="",e.question="",e.options=["",""],e.correctAnswers=[],e.explanation="",e.difficulty="",e.tags=[],p.value=""}catch(i){a.value=i.message||"Something went wrong."}finally{b.value=!1}}}const w={props:x,form:e,errors:d,submitting:b,successMessage:r,submitError:a,tagsInput:p,addOption:S,removeOption:A,toggleCorrect:C,validate:v,onSubmit:E};return Object.defineProperty(w,"__isScriptSetup",{enumerable:!1,value:!0}),w}}),T={class:"max-w-2xl mx-auto"},j={class:"card"},B={class:"grid gap-6"},M={key:0,class:"mt-1 text-sm text-red-600"},Q={key:0,class:"mt-1 text-sm text-red-600"},D={class:"flex items-center justify-between mb-2"},P={class:"flex gap-2"},Y=["disabled"],F={class:"text-xs text-gray-500"},z={class:"space-y-3"},J=["id","checked","onChange"],L={class:"flex-1"},R={class:"flex gap-2"},G=["onUpdate:modelValue","placeholder"],H=["onClick","disabled"],K=["for"],W={key:0,class:"mt-1 text-sm text-red-600"},X={key:1,class:"mt-1 text-sm text-red-600"},Z=["value"],$={key:0,class:"mt-1 text-sm text-red-600"},ee={key:0,class:"mt-1 text-sm text-red-600"},te={class:"grid md:grid-cols-2 gap-4"},oe={class:"flex items-center gap-3"},re=["disabled"],se={key:0},ie={key:1},ne={key:0,class:"text-green-600"},le={key:1,class:"text-red-600"};function ae(y,o,x,e,d,b){return l(),n("div",T,[t("div",j,[o[20]||(o[20]=t("h2",{class:"text-2xl font-heading font-bold text-gray-900 mb-6"},"Submit a Question",-1)),o[21]||(o[21]=t("p",{class:"text-gray-600 mb-6"}," Submit your own quiz question. Submissions are reviewed before appearing in the catalog. ",-1)),t("form",{onSubmit:O(e.onSubmit,["prevent"]),novalidate:""},[u(t("input",{"onUpdate:modelValue":o[0]||(o[0]=r=>e.form.website=r),type:"text",class:"hidden",autocomplete:"off",tabindex:"-1","aria-hidden":"true"},null,512),[[c,e.form.website]]),t("div",B,[t("div",null,[o[9]||(o[9]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Title",-1)),u(t("input",{"onUpdate:modelValue":o[1]||(o[1]=r=>e.form.title=r),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-primary focus:border-primary",required:""},null,512),[[c,e.form.title,void 0,{trim:!0}]]),e.errors.title?(l(),n("p",M,m(e.errors.title),1)):f("",!0)]),t("div",null,[o[10]||(o[10]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Question",-1)),u(t("textarea",{"onUpdate:modelValue":o[2]||(o[2]=r=>e.form.question=r),rows:"4",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-primary focus:border-primary",required:""},null,512),[[c,e.form.question,void 0,{trim:!0}]]),e.errors.question?(l(),n("p",Q,m(e.errors.question),1)):f("",!0)]),t("div",null,[t("div",D,[o[11]||(o[11]=t("label",{class:"block text-sm font-medium text-gray-700"},"Answer Options",-1)),t("div",P,[t("button",{type:"button",onClick:e.addOption,class:"text-sm text-primary hover:underline",disabled:e.form.options.length>=6},"Add option",8,Y),t("span",F,m(e.form.options.length)+"/6",1)])]),t("div",z,[(l(!0),n(k,null,h(e.form.options,(r,a)=>(l(),n("div",{key:a,class:"flex items-start gap-3"},[t("input",{type:"checkbox",id:"correct-"+a,class:"mt-2",checked:e.form.correctAnswers.includes(a),onChange:p=>e.toggleCorrect(a)},null,40,J),t("div",L,[t("div",R,[u(t("input",{"onUpdate:modelValue":p=>e.form.options[a]=p,placeholder:`Option ${String.fromCharCode(65+a)}`,class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-primary focus:border-primary"},null,8,G),[[c,e.form.options[a],void 0,{trim:!0}]]),t("button",{type:"button",onClick:p=>e.removeOption(a),class:"px-2 py-2 text-sm text-gray-500 hover:text-red-600",disabled:e.form.options.length<=2},"Remove",8,H)]),t("label",{for:"correct-"+a,class:"text-xs text-gray-600"},"Check if this option is correct",8,K)])]))),128))]),e.errors.options?(l(),n("p",W,m(e.errors.options),1)):f("",!0),e.errors.correctAnswers?(l(),n("p",X,m(e.errors.correctAnswers),1)):f("",!0)]),t("div",null,[o[12]||(o[12]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Explanation (optional)",-1)),u(t("textarea",{"onUpdate:modelValue":o[3]||(o[3]=r=>e.form.explanation=r),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-primary focus:border-primary"},null,512),[[c,e.form.explanation,void 0,{trim:!0}]])]),t("div",null,[o[14]||(o[14]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Category",-1)),u(t("select",{"onUpdate:modelValue":o[4]||(o[4]=r=>e.form.categoryId=r),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-primary focus:border-primary",required:""},[o[13]||(o[13]=t("option",{value:""},"Select a category",-1)),(l(!0),n(k,null,h(e.props.categories,r=>(l(),n("option",{key:r._id,value:r._id},m(r.name),9,Z))),128))],512),[[_,e.form.categoryId]]),e.errors.categoryId?(l(),n("p",$,m(e.errors.categoryId),1)):f("",!0)]),t("div",null,[o[16]||(o[16]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Difficulty",-1)),u(t("select",{"onUpdate:modelValue":o[5]||(o[5]=r=>e.form.difficulty=r),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-primary focus:border-primary",required:""},o[15]||(o[15]=[t("option",{value:""},"Select difficulty",-1),t("option",{value:"beginner"},"Beginner",-1),t("option",{value:"intermediate"},"Intermediate",-1),t("option",{value:"advanced"},"Advanced",-1)]),512),[[_,e.form.difficulty]]),e.errors.difficulty?(l(),n("p",ee,m(e.errors.difficulty),1)):f("",!0)]),t("div",null,[o[17]||(o[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Tags (comma-separated, optional)",-1)),u(t("input",{"onUpdate:modelValue":o[6]||(o[6]=r=>e.tagsInput=r),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-primary focus:border-primary",placeholder:"e.g. components, sling, dispatcher"},null,512),[[c,e.tagsInput,void 0,{trim:!0}]])]),t("div",te,[t("div",null,[o[18]||(o[18]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Your Name (optional)",-1)),u(t("input",{"onUpdate:modelValue":o[7]||(o[7]=r=>e.form.submitterName=r),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-primary focus:border-primary"},null,512),[[c,e.form.submitterName,void 0,{trim:!0}]])]),t("div",null,[o[19]||(o[19]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Your Email (optional)",-1)),u(t("input",{"onUpdate:modelValue":o[8]||(o[8]=r=>e.form.submitterEmail=r),type:"email",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-primary focus:border-primary"},null,512),[[c,e.form.submitterEmail,void 0,{trim:!0}]])])]),t("div",oe,[t("button",{type:"submit",class:"btn-primary disabled:opacity-50",disabled:e.submitting},[e.submitting?(l(),n("span",se,"Submitting...")):(l(),n("span",ie,"Submit Question"))],8,re),e.successMessage?(l(),n("span",ne,m(e.successMessage),1)):f("",!0),e.submitError?(l(),n("span",le,m(e.submitError),1)):f("",!0)])])],32)])])}const me=U(N,[["render",ae]]);export{me as default};
